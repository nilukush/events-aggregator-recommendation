# Render Blueprint for EventNexus Background Worker
# This defines a Cron Worker that runs periodically to ingest events

services:
  # Background worker for event ingestion
  - type: worker
    name: eventnexus-worker
    env: node
    region: singapore
    buildCommand: npm install
    startCommand: npm run worker
    envVars:
      - key: NODE_VERSION
        value: 20
      - key: INGEST_URL
        value: https://events-aggregator-recommendation.vercel.app/api/ingest
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_ANON_KEY
        sync: false
      - key: CITY
        value: Dubai
      - key: LAT
        value: 25.2048
      - key: LNG
        value: 55.2708
      - key: RADIUS_KM
        value: 50

# Render Cron Jobs for scheduled execution
crons:
  # Run event ingestion every hour
  - name: event-ingestion-hourly
    schedule: "0 * * * *"
    command: npm run worker
    service: eventnexus-worker
